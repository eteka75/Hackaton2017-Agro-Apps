!function(t,e){"use strict";function n(){var t=document.querySelector(".app-active");null!==t.querySelector("div.backdrop-popover")&&t.removeChild(y),g.style.visibility="hidden",g.style.display="none","true"===g.getAttribute("data-virtual")&&document.body.removeChild(g),g=null}function i(){var t=document.createElement("div");return t.classList.add("popover"),t.setAttribute("id",a()),t.setAttribute("data-virtual","true"),document.body.appendChild(t),document.body.lastChild}function r(t){var e="string"==typeof t?t:t.text,n="string"==typeof t?t:t.value;return'<li><a class="padded-list" data-value="'+n+'">'+e+"</a></li>"}function o(t,e,n){if(!(e instanceof Array))throw new Error("The list of the popover must be an array, "+typeof e+" given");var i='<ul class="list">',o=r;"function"==typeof n&&(o=n);for(var a=0;a<e.length;a++)i+=o(e[a]);i+="</ul>",t.innerHTML=i}function a(){for(var t="",e="abcdefghijklmnopqrstuvwxyz",n=0;n<8;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function l(e){return!e.classList.contains("active")&&(h=!0,g=e,e.style.display="block",t.setTimeout(function(){e.style.visibility="visible",e.classList.add("active")},10),e.querySelector("ul").scrollTop=0,document.querySelector(".app-page.app-active").appendChild(y),!0)}function s(t,e){var n=document.querySelector(".app-page.app-active");if(e="string"==typeof e?n.querySelector(e):e,null===e)throw new Error("The trigger for the popover does not exists");if(l(t)){var i=e.getBoundingClientRect();t.style.width=e.clientWidth+"px",t.style.top=i.top+"px",t.style.left=i.left+"px"}}function c(e,n){if("undefined"==typeof n&&(n="left"),l(e)){var i=document.querySelector(".app-page.app-active"),r=i.currentStyle||t.getComputedStyle(i);if("title"===n||"title-left"===n){var o=i.querySelector(".header-bar");e.style.top=o.offsetHeight+"px","title"===n?e.style.left=o.clientWidth/2+parseInt(r.marginLeft)-e.clientWidth/2+"px":e.style.left=16+parseInt(r.marginLeft)+"px"}else"left"!==n&&"right"!==n||(e.style.top="12px","left"===n?e.style.left=16+parseInt(r.marginLeft)+"px":(e.style.left="auto",e.style.right="16px"))}}function u(e){h=!1,g=e,e.classList.contains("active")&&(e.classList.toggle("active"),t.setTimeout(function(){n()},250))}function d(){var t=!!g;return t&&u(g),t}function p(t,e,n){var e="string"==typeof e?document.querySelector(e):e;if(null===e)throw new Error("The button does not exists");var i=t.getAttribute("id");e.setAttribute("data-popover-id",i),n===!0&&e.setAttribute("data-autobind",!0)}function f(t){return{setList:function(e,n){return o(t,e,n),this},open:function(e){return c(t,e),this},openFrom:function(e){return s(t,e),this},close:function(){return u(t),this},onItemChanged:function(e){return m.push({id:t.getAttribute("id"),callback:e}),this},attachButton:function(e,n){return p(t,e,n),this}}}var v=!1,g=null,h=!1,y=document.createElement("div");y.classList.add("backdrop-popover");var m=[],b=function(t){for(var e={target:null,id:null,direction:null};t&&t!==document;t=t.parentNode){var n=t.getAttribute("data-popover-id");if(null!==n){e.target=t,e.id=n,e.direction="left",!t.classList.contains("title")&&t.classList.contains("pull-left")?e.direction="left":!t.classList.contains("title")&&t.parentNode.classList.contains("pull-left")?e.direction="left":t.classList.contains("title")&&t.classList.contains("pull-left")?e.direction="title-left":t.parentNode&&t.parentNode.classList.contains("pull-left")&&t.classList.contains("title")?e.direction="title-left":t.classList.contains("pull-right")?e.direction="right":t.parentNode&&t.parentNode.classList.contains("pull-right")?e.direction="right":t.classList.contains("center")?e.direction="title":t.parentNode&&t.parentNode.classList.contains("center")?e.direction="title":e.direction="button";break}}return e},L=function(t){for(;t&&t!==document;t=t.parentNode)if(t.classList.contains("popover")&&t.classList.contains("active"))return t;return!1},x=function(t){for(;t&&t!==document;t=t.parentNode)if(t===g)return!0;return!1};document.on(e.event.start,function(t){t=t.originalEvent||t,!L(t.target)&&h&&u(g),v=!1}),document.on(e.event.move,function(t){t=t.originalEvent||t,v=!0}),document.on(e.event.end,function(t){var e=t.target,n=b(e),i=document.querySelector("#"+n.id);if(n.target&&i&&(i.classList.contains("active")&&!v?u(i):"button"===n.direction?s(i,n.target):c(i,n.direction)),null!==e.parentNode&&x(e)&&!v){u(g);var r={text:e.textContent,value:e.getAttribute("data-value"),target:t.target};t=new CustomEvent("itemchanged",{detail:r,bubbles:!0,cancelable:!0});for(var o=document.querySelectorAll('[data-popover-id="'+g.id+'"]'),a=o.length-1;a>=0;a--){var n=o[a];"true"===n.getAttribute("data-autobind")&&("textContent"in n?n.textContent=e.textContent:n.innerText=e.innerText)}g.dispatchEvent(t);for(var a=0;a<m.length;a++){var l=m[a];l.id===g.getAttribute("id")&&l.callback(r)}}}),e.popover=function(t){if("string"==typeof t&&"_caller"===t)return f();if("undefined"==typeof t)return f(i());var e="string"==typeof t?document.querySelector(t):t;if(null===e)throw new Error("The popover with ID "+t+" does not exists");return f(e)},e.popoverUtil={closeActive:d},t.phonon=e,"object"==typeof exports?module.exports=e.popover:"function"==typeof define&&define.amd&&define(function(){return e.popover})}("undefined"!=typeof window?window:this,window.phonon||{});